
title: OmezenÃ­ pÅ™iÅ™azenÃ­ rolÃ­ v GCP
date: '2023-06-04'
excerpt: PotÅ™ebujete omezit role, kterÃ© mohou uÅ¾ivatelÃ© pÅ™iÅ™azovat? Jste na sprÃ¡vnÃ©m mÃ­stÄ›!
content: |
  # OmezenÃ­ pÅ™iÅ™azovÃ¡nÃ­ rolÃ­ v GCP
  SprÃ¡va IAM rolÃ­ v GCP mÅ¯Å¾e bÃ½t sloÅ¾itÃ¡. Chcete, aby vÃ¡Å¡ tÃ½m mÄ›l flexibilitu pÅ™i pÅ™iÅ™azovÃ¡nÃ­ rolÃ­, ale zÃ¡roveÅˆ nechcete, aby nÄ›kdo omylem udÄ›lil pÅ™Ã­liÅ¡ Å¡irokÃ½ nebo nerelevantnÃ­ pÅ™Ã­stup. NaÅ¡tÄ›stÃ­ vÃ¡m podmÃ­nky IAM v GCP umoÅ¾ÅˆujÃ­ **omezit, kterÃ© role lze pÅ™iÅ™adit**â€Š-â€ŠideÃ¡lnÃ­ pro udrÅ¾enÃ­ bezpeÄnosti a zÃ¡roveÅˆ posÃ­lenÃ­ pravomocÃ­ vaÅ¡eho tÃ½mu.

  ## ğŸ’¡ PÅ™Ã­pad pouÅ¾itÃ­: Kontrola pÅ™iÅ™azovÃ¡nÃ­ rolÃ­
  PÅ™edstavte si, Å¾e spravujete projekt GCP, kde vÃ½vojÃ¡Å™i Äasto potÅ™ebujÃ­ pÅ™iÅ™azovat role jako App Engine Admin nebo App Engine Viewer. MÅ¯Å¾ete omezit uÅ¾ivatele tak, aby mohli udÄ›lovat pouze tyto konkrÃ©tnÃ­ role, a tÃ­m zabrÃ¡nit neoprÃ¡vnÄ›nÃ½m pÅ™iÅ™azenÃ­m. To zajiÅ¡Å¥uje soulad a zabraÅˆuje neÃºmyslnÃ©mu zvÃ½Å¡enÃ­ oprÃ¡vnÄ›nÃ­.

  ## âš™ï¸ Jak na to: OmezenÃ­ pÅ™iÅ™azovÃ¡nÃ­ rolÃ­ pomocÃ­ IAM podmÃ­nek
  PomocÃ­ role **roles/resourcemanager.projectIamAdmin** s vlastnÃ­ podmÃ­nkou mÅ¯Å¾ete pÅ™esnÄ› definovat, kterÃ© role lze pÅ™iÅ™adit. Zde je postup:

  ### 1. NastavenÃ­ podmÃ­nky
  Definujte IAM podmÃ­nku pomocÃ­ nÃ¡sledujÃ­cÃ­ logiky:
  ```
  api.getAttribute("iam.googleapis.com/modifiedGrantsByRole", []).hasOnly([
    "roles/appengine.appAdmin",
    "roles/appengine.appViewer"
  ])
  ```
  TÃ­m zajistÃ­te, Å¾e uÅ¾ivatel mÅ¯Å¾e pÅ™iÅ™azovat pouze role **App Engine Admin** a **App Engine Viewer**.

  ### 2. PouÅ¾itÃ­ role s podmÃ­nkou
  PÅ™iÅ™aÄte roli **Project IAM Admin** s podmÃ­nkou pomocÃ­ Google Cloud CLI:

  ```
  gcloud projects add-iam-policy-binding [PROJECT_ID] \
    --member="user:[USER_EMAIL]" \
    --role="roles/resourcemanager.projectIamAdmin" \
    --condition=^:^'expression=api.getAttribute("iam.googleapis.com/modifiedGrantsByRole", []).hasOnly(["roles/appengine.appAdmin","roles/appengine.appViewer"]):title=app_roles_only:description=OmezenÃ­ pÅ™iÅ™azovÃ¡nÃ­ rolÃ­ pouze na specifickÃ© role App Engine'
  ```

  *SamozÅ™ejmÄ› mÅ¯Å¾ete dosÃ¡hnout stejnÃ©ho vÃ½sledku pomocÃ­ webovÃ©ho portÃ¡lu nebo IaC.*

  JelikoÅ¾ vÃ½raz obsahuje ÄÃ¡rky, je nutnÃ© pouÅ¾Ã­t alternativnÃ­ oddÄ›lovaÄ pro oddÄ›lenÃ­ podmÃ­nek. Toho je dosaÅ¾eno pouÅ¾itÃ­m ^:^ jako urÄenÃ©ho oddÄ›lovaÄe.

  ### 3. TestovÃ¡nÃ­ podmÃ­nky
  Pro ovÄ›Å™enÃ­ se pokuste pÅ™iÅ™adit omezenou roli pomocÃ­ uÅ¾ivatele, kterÃ©mu byla pÅ™iÅ™azena podmÃ­nÄ›nÃ¡ role:

  **ÃšspÄ›ch**: PÅ™iÅ™azenÃ­ roles/appengine.appAdmin funguje.
  **SelhÃ¡nÃ­**: PÅ™iÅ™azenÃ­ roles/storage.admin je zamÃ­tnuto.

  ## ğŸŒ PÅ™Ã­klad z reÃ¡lnÃ©ho svÄ›ta

  ### OmezenÃ­ automatizaÄnÃ­ho ÃºÄtu podle PoLP
  V jednom projektu jsme mÄ›li automatizaÄnÃ­ skript, kterÃ½ pÅ™iÅ™azoval role uÅ¾ivatelÅ¯m pÅ™i vytvÃ¡Å™enÃ­ novÃ½ch projektÅ¯ GCP. Abychom dodrÅ¾eli princip nejmenÅ¡Ã­ch oprÃ¡vnÄ›nÃ­ (PoLP), omezili jsme automatizaÄnÃ­ ÃºÄet tak, aby mohl pÅ™iÅ™azovat pouze nezbytnÃ¡ oprÃ¡vnÄ›nÃ­, kterÃ¡ jsme potÅ™ebovali.
  TÃ­m jsme zajistili, Å¾e automatizace nemohla pÅ™iÅ™azovat nechtÄ›nÃ© role, minimalizovali jsme rizika a zÃ¡roveÅˆ udrÅ¾eli proces efektivnÃ­.

  ## ğŸ“ ZÃ¡vÄ›reÄnÃ© myÅ¡lenky
  KombinacÃ­ podmÃ­nek s IAM rolemi mÅ¯Å¾ete:
  - Zajistit, Å¾e budou udÄ›lovÃ¡ny pouze autorizovanÃ© role.
  - ChrÃ¡nit svÃ© zdroje pÅ™ed neÃºmyslnÃ½m zvÃ½Å¡enÃ­m oprÃ¡vnÄ›nÃ­.
  - UmoÅ¾nit bezpeÄnÃ© automatizaÄnÃ­ procesy bez kompromisÅ¯ v oblasti bezpeÄnosti.

  PodmÃ­nky mÅ¯Å¾ete takÃ© pouÅ¾Ã­t k omezenÃ­ pÅ™Ã­stupu ke zdrojÅ¯m s konkrÃ©tnÃ­m nÃ¡zvem nebo atributem. Toto tÃ©ma vÅ¡ak mÅ¯Å¾e bÃ½t pokryto v budoucÃ­m ÄlÃ¡nku.
